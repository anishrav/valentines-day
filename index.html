<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CASE #0214: RAVIPATI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
    <style>
        :root {
            --retro-green: #4ade80;
            --retro-dark: #052e16;
            --crt-scanline: rgba(18, 16, 16, 0.1);
        }

        body {
            background-color: #000;
            color: var(--retro-green);
            font-family: 'VT323', monospace;
            overflow: hidden;
            height: 100vh;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* CRT Screen Effects */
        .crt-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            height: 90vh;
            border: 4px solid #333;
            border-radius: 20px;
            background: #0a0a0a;
            box-shadow: 0 0 20px var(--retro-green), inset 0 0 50px rgba(0,0,0,0.8);
            overflow: hidden;
        }

        .scanlines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                rgba(255,255,255,0),
                rgba(255,255,255,0) 50%,
                rgba(0,0,0,0.2) 50%,
                rgba(0,0,0,0.2)
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 50;
        }

        .glow-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(74, 222, 128, 0.1) 0%, rgba(0,0,0,0.4) 100%);
            pointer-events: none;
            z-index: 40;
            animation: flicker 0.15s infinite;
        }

        @keyframes flicker {
            0% { opacity: 0.95; }
            50% { opacity: 1; }
            100% { opacity: 0.98; }
        }

        /* Typography */
        h1, h2, .pixel-font {
            font-family: 'Press Start 2P', cursive;
            text-transform: uppercase;
        }

        /* Navigation Tabs */
        .nav-btn {
            border: 2px solid var(--retro-green);
            background: transparent;
            color: var(--retro-green);
            padding: 10px 20px;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.1s;
        }
        .nav-btn:hover, .nav-btn.active {
            background: var(--retro-green);
            color: black;
            box-shadow: 0 0 10px var(--retro-green);
        }

        /* EKG Animation */
        .ekg-wrapper {
            position: relative;
            height: 100px;
            border: 1px solid var(--retro-green);
            background: rgba(0, 20, 0, 0.8);
            overflow: hidden;
        }
        .ekg-line {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            fill: none;
            stroke: var(--retro-green);
            stroke-width: 3;
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: drawLine 2s linear infinite;
        }
        @keyframes drawLine {
            to { stroke-dashoffset: 0; }
        }

        /* 8-bit Heart */
        .pixel-heart {
            width: 20px;
            height: 20px;
            background-color: red;
            display: inline-block;
            margin: 0 10px;
            box-shadow: 
                -5px 0 0 0 red, 5px 0 0 0 red, 
                -10px 5px 0 0 red, 10px 5px 0 0 red, 
                -15px 10px 0 0 red, 15px 10px 0 0 red, 
                -10px 15px 0 0 red, 10px 15px 0 0 red, 
                -5px 20px 0 0 red, 5px 20px 0 0 red, 
                0 25px 0 0 red;
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* Animations */
        .blink { animation: blinker 1s linear infinite; }
        @keyframes blinker { 50% { opacity: 0; } }

        /* Modal */
        #modal {
            background: rgba(0,0,0,0.95);
            border: 4px solid var(--retro-green);
            box-shadow: 0 0 30px var(--retro-green);
        }

        .glitch-btn {
            position: relative;
            transition: all 0.1s;
        }

        /* Canvas for confetti */
        #confetti-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
        }
    </style>
</head>
<body>

    <div class="crt-container flex flex-col p-6">
        <div class="scanlines"></div>
        <div class="glow-overlay"></div>

        <header class="flex justify-between items-end border-b-2 border-green-500 pb-4 mb-6 z-10 relative">
            <div>
                <h1 class="text-xl md:text-2xl text-green-400 mb-2">VALENTINE OS <span class="text-xs ml-2 text-green-700">v2026.1</span></h1>
                <p class="text-lg">PATIENT: RAVIPATI, ANISH <span class="blink">_</span></p>
            </div>
            <div class="text-right">
                <p class="text-sm">DOB: 09/17/99</p>
                <p class="text-sm text-red-500 font-bold animate-pulse">STATUS: CRITICAL</p>
            </div>
        </header>

        <nav class="flex gap-4 mb-6 z-10 relative">
            <button onclick="switchTab('vitals')" class="nav-btn active" id="btn-vitals">VITALS</button>
            <button onclick="switchTab('hpi')" class="nav-btn" id="btn-hpi">H.P.I.</button>
            <button onclick="switchTab('labs')" class="nav-btn" id="btn-labs">LAB RESULTS</button>
        </nav>

        <main class="flex-grow z-10 relative overflow-y-auto">
            
            <div id="vitals" class="tab-content">
                <div class="grid grid-cols-2 gap-6 mb-6">
                    <div class="border border-green-800 p-4 bg-black/50">
                        <h3 class="pixel-font text-xs mb-2 text-green-600">HEART RATE</h3>
                        <div class="text-4xl font-mono flex items-center gap-4">
                            <span id="bpm-display">85</span> BPM
                            <div class="pixel-heart"></div>
                        </div>
                    </div>
                    <div class="border border-green-800 p-4 bg-black/50">
                        <h3 class="pixel-font text-xs mb-2 text-green-600">O2 SATURATION</h3>
                        <div class="text-4xl font-mono">100%</div>
                        <div class="text-xs mt-2 text-green-600">HYPERVENTILATING</div>
                    </div>
                </div>

                <div class="ekg-wrapper rounded mb-4">
                    <svg viewBox="0 0 500 100" class="ekg-line" preserveAspectRatio="none">
                        <polyline points="0,50 100,50 110,20 120,80 130,50 200,50 210,10 220,90 230,50 350,50 360,20 370,80 380,50 500,50" 
                                  fill="none" stroke="#4ade80" stroke-width="2" vector-effect="non-scaling-stroke"/>
                    </svg>
                </div>
                <p class="font-mono text-sm">> SYSTEM NOTE: EKG spikes detected when subject thinks about "The Wedding".</p>
            </div>

            <div id="hpi" class="hidden tab-content">
                <div class="border border-green-800 p-6 bg-black/50 font-mono text-xl leading-relaxed min-h-[300px]">
                    <span id="typewriter-text"></span><span class="blink">â–ˆ</span>
                </div>
            </div>

            <div id="labs" class="hidden tab-content">
                <table class="w-full text-left font-mono text-lg border-collapse">
                    <tr class="border-b border-green-900 text-green-600">
                        <th class="py-2 pixel-font text-xs">MARKER</th>
                        <th class="py-2 pixel-font text-xs">VALUE</th>
                        <th class="py-2 pixel-font text-xs">REF RANGE</th>
                    </tr>
                    <tr class="border-b border-green-900/50">
                        <td class="py-4">SERUM HAPPINESS</td>
                        <td class="py-4 text-green-300">UNKNOWN</td>
                        <td class="py-4 text-green-700">10-20</td>
                    </tr>
                    <tr class="border-b border-green-900/50">
                        <td class="py-4">LOVE LEVEL</td>
                        <td class="py-4 text-red-500 blink">OVERLOAD</td>
                        <td class="py-4 text-green-700">< 100</td>
                    </tr>
                </table>
                <div class="mt-6 border border-green-500 p-2 text-center bg-green-900/20">
                    <p class="pixel-font text-xs mb-2">DIAGNOSTIC IMAGING</p>
                    <p class="font-mono text-sm">[ IMAGE CORRUPTED: TOO CUTE TO RENDER ]</p>
                </div>
            </div>

        </main>

        <footer class="mt-4 z-10 relative text-center">
            <button onmouseover="speedUpHeart()" onmouseout="slowDownHeart()" onclick="openModal()" class="pixel-font bg-green-600 text-black px-6 py-4 hover:bg-green-500 hover:scale-105 transition-transform shadow-[4px_4px_0px_0px_rgba(255,255,255,0.5)]">
                > SUBMIT DIAGNOSIS
            </button>
        </footer>
    </div>

    <div id="modal" class="fixed inset-0 hidden flex items-center justify-center z-50 p-4">
        <div class="border-4 border-green-500 bg-black p-8 max-w-md w-full text-center relative shadow-[0_0_50px_rgba(74,222,128,0.5)]">
            <h2 class="text-2xl mb-6 text-green-400">CONFIRM TREATMENT</h2>
            <p class="font-mono text-xl mb-8 leading-relaxed">
                Patient requires you to be his Valentine.
                <br><br>
                Do you accept this consult?
            </p>
            
            <div class="flex flex-col gap-4 items-center">
                <button onclick="celebrate()" class="pixel-font bg-green-600 text-black px-8 py-3 w-full hover:bg-green-400 transition">
                    [ YES ] - ACCEPT
                </button>
                <button id="no-btn" onmouseover="dodge(this)" onclick="dodge(this)" class="pixel-font border border-red-500 text-red-500 px-8 py-3 w-full hover:bg-red-900/30 transition duration-75">
                    [ NO ] - DECLINE
                </button>
            </div>
        </div>
    </div>

    <canvas id="confetti-canvas"></canvas>

    <script>
        // --- TYPEWRITER EFFECT ---
        const hpiText = "SUBJECT: Anish Ravipati (26M).\n\nCHIEF COMPLAINT: Patient reports symptoms of extreme affection and excitement for upcoming 2026 nuptials.\n\nHISTORY: Symptoms began approx. April 2025. Patient states: 'She is the best doctor I know.'\n\nASSESSMENT: Condition is chronic and incurable without a Valentine's Date intervention.";
        let i = 0;
        const speed = 30; 
        let hasTyped = false;

        function typeWriter() {
            if (i < hpiText.length) {
                document.getElementById("typewriter-text").innerHTML += hpiText.charAt(i) === '\n' ? '<br>' : hpiText.charAt(i);
                i++;
                setTimeout(typeWriter, speed);
            }
        }

        // --- TABS ---
        function switchTab(tabId) {
            // Hide all contents
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            // Show selected
            document.getElementById(tabId).classList.remove('hidden');
            
            // Update buttons
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('btn-'+tabId).classList.add('active');

            // Trigger typing if HPI is clicked for first time
            if(tabId === 'hpi' && !hasTyped) {
                hasTyped = true;
                typeWriter();
            }
        }

        // --- EKG LOGIC ---
        const ekgLine = document.querySelector('.ekg-line');
        const bpmDisplay = document.getElementById('bpm-display');
        
        function speedUpHeart() {
            ekgLine.style.animationDuration = '0.5s'; // Fast!
            bpmDisplay.innerText = "185";
            bpmDisplay.classList.add('text-red-500');
        }

        function slowDownHeart() {
            ekgLine.style.animationDuration = '2s'; // Normal
            bpmDisplay.innerText = "85";
            bpmDisplay.classList.remove('text-red-500');
        }

        // --- MODAL & BUTTON GAME ---
        function openModal() {
            document.getElementById('modal').classList.remove('hidden');
        }

        let attempts = 0;
        function dodge(btn) {
            attempts++;
            
            // Shrink
            const currentScale = 1 - (attempts * 0.15);
            if (currentScale < 0.1) {
                btn.style.opacity = 0;
                btn.style.pointerEvents = 'none';
                return;
            }
            
            // Random Translation (Glitch movement)
            const x = (Math.random() - 0.5) * 100;
            const y = (Math.random() - 0.5) * 100;
            
            btn.style.transform = `scale(${currentScale}) translate(${x}px, ${y}px)`;
            
            // Change Text
            const texts = ["ERROR", "404", "DENIED", "TRY AGAIN", "NOPE", "GLITCH"];
            btn.innerText = `[ ${texts[attempts % texts.length]} ]`;
        }

        // --- CONFETTI (8-BIT HEARTS) ---
        function celebrate() {
            const modal = document.getElementById('modal');
            modal.innerHTML = `
                <h1 class="text-4xl text-green-400 mb-4 animate-bounce">ACCEPTED!</h1>
                <p class="font-mono text-xl">See you on Feb 14th!</p>
                <div class="mt-8 pixel-heart" style="transform: scale(3)"></div>
            `;
            
            startConfetti();
        }

        function startConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const particles = [];
            
            // Create particles
            for(let k = 0; k < 150; k++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    size: Math.random() * 10 + 5,
                    speed: Math.random() * 5 + 2,
                    color: `hsl(${Math.random() * 60 + 330}, 100%, 50%)` // Pinks and Reds
                });
            }

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(p => {
                    ctx.fillStyle = p.color;
                    // Draw square for pixel look
                    ctx.fillRect(p.x, p.y, p.size, p.size);
                    p.y += p.speed;
                    
                    if(p.y > canvas.height) p.y = -10;
                });
                requestAnimationFrame(draw);
            }
            draw();
        }
    </script>
</body>
</html>
